<?xml version="1.0" encoding="UTF-8"?>
<project name="Build project" default="build">

    <target name="build" depends="copyFiles,concatJS,deleteSrc,minifyJs" description="Build mucilage"/>
	
    <target name="copyFiles" description="Copy the files needed in the deploy folder">
    	<copy todir="../../build/" overwrite="true">
	    <fileset dir="../">
		<include name="*.js" />
	    </fileset>
	</copy>
    </target>
    
    <target name="concatJS">
	<concat destfile="../../build/mucilage.js">
	    <filelist dir="./" files="head.js" />
	    <filelist dir="../../build/" files="core.js,helper.js,data.js,template.js" />
	    <filelist dir="./" files="foot.js" />
    	</concat>
	<concat destfile="../../build/mucilage-light.js">
	    <filelist dir="./" files="head.js" />
	    <filelist dir="../../build/" files="core.js,helper.js,data.js,templateLight.js" />
	    <filelist dir="./" files="foot.js" />
    	</concat>
    </target>

    <target name="deleteSrc">
	<delete>
	    <fileset dir="../../build/">
		<include name="*.js" />
		<exclude name="mucilage.js" />
		<exclude name="mucilage-light.js" />
	    </fileset>
	</delete>
    </target>

    <target name="minifyJs" description="Minify JS files">
	<java jar="../../../yuicompressor-2.4.6.jar" fork="true" failonerror="true">
	    <arg line="--charset utf-8"/>
	    <arg line="-o '../../build/mucilage.js'"/>
	    <arg line="'../../build/mucilage.js'"/>
	</java>
	<java jar="../../../yuicompressor-2.4.6.jar" fork="true" failonerror="true">
	    <arg line="--charset utf-8"/>
	    <arg line="-o '../../build/mucilage-light.js'"/>
	    <arg line="'../../build/mucilage-light.js'"/>
	</java>

    </target>
</project>
