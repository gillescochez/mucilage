/*! github.com/gillescochez/mucilage */
(function(){function mucilage(a,b,c){return new mucilage.init(a,b,c)}function extend(a,b,c){if(!b)return a;var d,e,f,g={};c&&extend(g,a);for(d in b){e=a[d],f=b[d];if(a===f)continue;f!==undefined&&((c?g:a)[d]=f)}return c?g:a}function isObject(a){return typeof a=="object"}function isArray(a){return isObject(a)?a.constructor==Array:!1}mucilage.settings={special:!0},mucilage.init=function(a,b,c){if(isObject(a)&&!isArray(a)){extend(mucilage.settings,a);return}return mucilage._template(this,a),mucilage.bind(this,b,c),c&&mucilage.update(this,c),mucilage.settings.special&&(this._=function(a,b){if(a)b?extend(this[1],a):this[1]=a,c&&mucilage.update(this,c);else return this[1]},this.$=function(a){if(!a)return this[0](this[1]);mucilage._template(this,a)}),this},mucilage.update=function(a,b){var c=b.length,d=0;if(c)for(;d<c;d++)b[d].innerHTML=a[0](a[1]);else b.innerHTML=a[0](a[1])},mucilage._template=function(a,b){isArray(b)?a[0]=mucilage.template.apply(a,b):a[0]=mucilage.template(b)},mucilage.bind=function(a,b,c){var d;a[1]={};for(d in b)a[1][d]=b[d]||null,function(b){a[b]=function(d){if(!d)return a[1][b];a[1][b]=d,c&&(c.innerHTML=a[0](a[1]))}}(d)},mucilage.templateEngine=function(){var resolveDefs=function(c,block,def){return(typeof block=="string"?block:block.toString()).replace(c.define,function(match,code,assign,value){return code.indexOf("def.")===0&&(code=code.substring(4)),code in def||(assign===":"?def[code]=value:eval("def[code]="+value)),""}).replace(c.use,function(match,code){var v=eval(code);return v?resolveDefs(c,v,def):v})};return{init:function(a,b,c){b=extend(mucilage.templateEngine.settings,b,!0);var d=b.append?"'+(":"';out+=(",e=b.append?")+'":");out+='",f=b.use||b.define?resolveDefs(b,a,c||{}):a;f=("var out='"+(b.strip?f.replace(/\s*<!\[CDATA\[\s*|\s*\]\]>\s*|[\r\n\t]|(\/\*[\s\S]*?\*\/)/g,""):f).replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(b.interpolate,function(a,b){return d+b.replace(/\\'/g,"'").replace(/\\\\/g,"\\").replace(/[\r\t\n]/g," ")+e}).replace(b.encode,function(a,b){return d+b.replace(/\\'/g,"'").replace(/\\\\/g,"\\").replace(/[\r\t\n]/g," ")+").toString().replace(/&(?!\\w+;)/g, '&#38;').split('<').join('&#60;').split('>').join('&#62;').split('"+'"'+"').join('&#34;').split("+'"'+"'"+'"'+").join('&#39;').split('/').join('&#47;'"+e}).replace(b.evaluate,function(a,b){return"';"+b.replace(/\\'/g,"'").replace(/\\\\/g,"\\").replace(/[\r\t\n]/g," ")+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").split("out+='';").join("").split("var out='';out+=").join("var out=");try{return new Function(b.varname,f)}catch(g){throw g}}}}(),mucilage.template=mucilage.templateEngine.init,mucilage.templateEngine.settings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,varname:"$",strip:!0,append:!0},mucilage.templateSettings=function(a){extend(mucilage.templateEngine.settings,a)},window.mucilage=mucilage})()